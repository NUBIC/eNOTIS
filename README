== Welcome to eNOTIS ==

eNOTIS is a research tool provided by NUCATS to aid researchers in managing patients on clinical trials. Developed in response to requests from the NU clinical research community, eNOTIS will be the primary clinical trial management system for all research at Northwestern University, utilizing the latest in web technology and security measures. Subject safety is at the core of the system: eNOTIS is both HIPAA compliant and recognized by the Northwestern IRB as an approved clinical research system. eNOTIS speeds up clinical trial set-up time by providing access to information about clinical studies through eIRB and to patient medical records through the NU Enterprise Data Warehouse (EDW). This approach means less data entry and will reduce or eliminate the need for manual study tracking adoption.

== Installation ==

eNOTIS requires a few commands to get the data to start up:

    rake users:create_admins # creates admin users
    rake redis #imports data from redis store
    
== Dependencies ==

eNOTIS depends on a few important gems:

* bundler, currently the 0.9 branch
* pg, which may require archflags for OSX when you bundle: > env ARCHFLAGS="-arch i386" gem bundle
* and credentials files:
  - /etc/nubc/bcsec-[environment].yml, e.g. /etc/nubc/bcsec-staging.yml (not needed in development)

  - /etc/nubc/edw-[environment].yml, e.g. /etc/nubc/edw-staging.yml, which should contain the following keys:
  
    username:
    password:
    service_timeout:
    url:
    test_mrn:
  
  - /etc/nubc/eirb-[environment].yml, e.g. /etc/nubc/eirb-staging.yml, which should contain the following keys:

    url:
    username: 
    password:

  - /etc/nubc/db/p[environment].yml, e.g. /etc/nubc/pstage.yml (not needed in development or test)

  - /etc/nubc/couch-[environment].yml, e.g. /etc/nubc/couch-development.yml, which should contain the following keys:

    url: "http://localhost"
    port: 5984
    db: "eirb_prod"
  
== Changes ==

1.6.1

* links and dashes for later pages on datatables. closes #3495
* clicking delete and then cancel results in a page redirect to the involvements page. fix to prevent following link if cancel is pressed. closes #3497
* show other studies view from other studies flag. closes #3496
* updating readme to reflect changes in 1.6.0

1.6.0

* we're only jumping one version
* upgrading to version 1.7 and properly tagging it
* upgrading one more version of cucumber
* Removing more unneeded stuff from the rspec upgrade
* Locking eNOTIS into rspec 1.3 and locking resque-spec into 0.2
* Ajaxified the deletion of subjects from studies. Now, any link that has a class of get, post, put, or delete will be automatically unobtrusively ajaxified. Also, forms can be ajaxified if they have class ajaxForm.
* Removing Involvments from studies in a non-ajax way. References #2749
* added google analytics tracking code
* changing a note in the readme
* active mq changes
* added webservice to return a users study roles given a netid
* Cucumber now passes with resque-spec installed
* involvement unit tests pass
* bringing empi and savon gem back into gemfile, and silencing a deprecation warning
* locking cucumber to 0.8.3 for now
* disabling empi part II
* Learn how to use mocking for a server
* initial work on empi and a fix to subject importing
* cleaning up deployment script and fixing staging resque worker
* More work on NOTIS import process
* Preliminary work on importing NOTIS patients into eNOTIS. references #3067
* ui tweak for read only involvment view
* small UI tweak for read only study messages
* added read only study feature to eNOTIS. closes #3212
* Renamed resque workers to cut down on verbosity and to have their class names better describe their function
* lighter background for videos
* Upgrade to rails 2.3.8. closes #3219
* Importing EDW subjects into redis, and truncating overly long project roles

1.5.0

* Study Tables have been converted from java+ruby to unobtrusive javascript. Closes #3164
* add video to studies without accruals. closes #1352
* removing fake report
* merging demo work. closes #2775
* removing fake psa report
* moving tooltip hovers back inside document.ready #3164
* fixing nih totals. placing nih report under Reports button. references #2775
* nih report. references #2590
* show fake edw report on nugene only, with a datatable, limited number of subjects
* starting fake report
* other studies. references #2775
* starting fake report
* other studies
* other studies and reports for demo
* warren is an admin
* Ethnicity typo. Closes #3152
* updating bundler for hudson
* one small fix for cucumber
* Completing ticket #1538. Searches are now paginated and sorted via ajax
* embedding sudo in the deploy command works for me... it should work for other people too
* use sudo to restart resque workers
* video on static site
* enotis tutorial video
* unknown required date
* renaming completed => completed\_or\_withdrawn for clarity
* set timechart extreme to 1 to force 0 to bottom of chart
* new highcharts
* show last 12 months in time chart. closes #2776
* logos at bottom of front page now link to sites. closes #2979
* adjustments to admin layout
* turn of session reset. fixes login redirect issue. closes #2772.
* changed 'headers' to 'column headings' for clarity. closes #2777
* tutorial video. closes #1231
* Removed system status tracking... closes #2783
* This should fix hudson, i hope
* Locking resque to 1.8.2
* Revert "Updating Gemfile"
* Updating Gemfile
* Various redis, resque and monit updates
* Deployment: I've decreased the number of resque workers from 3 to 2 on production and staging since we don't need to do full imports at the moment
* eIRB import: Update netid populator to check if the user hash actually has data in it
* Full Import now uses the proper redis namespace and server on production
* wrong hostname on production resque
* Revert gems for hudson
* Removing more couchdb code and also refining import process

1.4.0

* Everyone can see resque now under admin/jobs using the username and password enotis_jobs
* one more fix to migrations
* fix to new demo migration
* update to the migration. was not working on staging
* fixing the addresses for resque and redis
* removing some extraneous foreign key checks
* one weird little database change
* One last check before deploying this to staging
* fix for demographics export in pdf and csv
* Specs and features pass on demographics change. Some minor UI work is still needed but fuctionality is there.
* Refactored and Finished Review Board and Data Warehouse import
* removed subject index. references #2667
* fixing pretty_status spec to account for sorting
* separate study status and title. add long and short title to study detail page. sort studies by status. closes #2595. closes #2773.
* search by title and name
* modified the role updating task to work on postgresql 8.3
* specs and features passing on demographics change. also fixed a study import bug regarding two digit years, the study_upload model was
trying to convert the data before the special code for two digit years was run, this caused an error
* Updated eNOTIS import project to use the edw and import authorized personnel successfully
* Updated rake populate script for change from coordinators to roles, and to support new FK constraints on deleting everything
* paper trail uses a different, thread safe method, to store whodunnit. this customization was interfering with the new method. just sto
re user ids. closes #2830
* won't validate presence_of involvement for now, until Rails 2.3.6 patch
* won't validate presence_of involvement for now, until Rails 2.3.6 patch
* validate presence, not numericality, of involvement\_id in involvement\_event
* validate involvmenet events date and involvement_id. closes #2829
* reverting the validation
* adding in more queues for error tracking
* specs passing now. some edw adapter specs need refactoring. they are fragile
* had to change the database.yml to fix a bug in postgres 8.4 which I use on my dev machine
* updated edw webservices to work with multiple reports. Report names are defined in the Edw class
* fix for spec failing - added more involvement events
* getting specs to pass
* updated redis importing to account for authorized personnel not marked as principal_investigator or coinvestigators
* getting specs to pass
* updated redis importing to account for authorized personnel not marked as principal_investigator or coinvestigators
* fake pi name for demo
* updated dates for demo
* more specific on tooltips - keeps add button from accidentally being a tooltop
* start with charts rolled up
* time chart, line and bar. closes #2593
* tooltips for study
* Additional resque queues
* show charts in study detail page only. icon for charts.
* Additional resque queues
* blank pi's for now
* ignoring rackup file
* adding unicorn and fixing gemfile* error pages: spilled milk. aw snap. ruh roh.
* Updated specs and features from changes to datamodel, specs and features passing
* an attempt at better error pages
* changing study detail page header layout. show irb number, full text of status, subjects/goal, and name in one line. details and graph
s button for toggling graphs.
* helpers for prettier study title and status
* user auth doesn't need forget_me
* removed muliti institute import field from translation and eirb redis import. This field is not used consistently in eirb for us to det
ermine if a study is multi-institute or not
* updated branch to handle the funding sources as child model of the study. Added code to the redis import process to get the data into 
the models
* upgrading Gemfile and resque notes
* Fixing study import
* more work on importing
* More work on #2254. removed couch stuff and simplified a bit
* Update config files to account for more environments
* updating documentation and initial work on replacing couchdb with redis
* refactoring populators
* adding the ability to pull in just the most recently modified studies (within 1 day)
* Locking multi-job-forks
* More work on redis importing and migrating from couch to redis
* quick fix
* Finishing up notes for redis
* Additional resque notes
* We're now importing study description and inclusion and exclusion
* import data from redis to studies and users
* renamed activerecord resque task
* more work
* further chopping up of work
* quick commit
* adding in the first steps for referencing the EIRB and chopping it up with resque
* Standalone scripts should have the shebang and be executable
* Initial Resque Setup for development. references #2254

1.3.0

* both enotissupport and enotis emails on front page
* hide dotchart for studies without involvements
* forcing index\_coming\_soon to use application layout
* static assets are symlinked now, no copying needed
* new graphics for measure see improve
* symlink instead of copy static site assets. change layout to match new colors. static version bump
* dot chart for accruals (consented) only
* g.raphael dot chart for accruals by month and by day of week. closes #2594
* include subjects in study retrieval for more efficient db queries
* method to count involvement events by month and by day of week. for dot chart.
* user auth doesn't need forget_me
* Date picker for birth dates should not automatically close when a date is selected. closes #2631
* rake task to add coordinators manually by netid/irb number. references #2298
* coordinators should have studies and users
* display accrual and goal as ratio
* two digit year class should handle blanks
* accept downcase attributes, set them to the proper case. closes #2666
* better instructions for imports. references #1947
* show involvement errors in flash message on create as well
* validate uniqueness of involvement events by event, date, and involvement. closes #2319
* add parenthesis to a randomizer in fake_subject factory

1.2.1

* fixing bad ranges in death dates for fake subjects. closes #2629
* handle csv exceptions better. closes #2320
* removing old admin scenario
* exclude searches in studies activities
* more efficient queries, allow less vertical spacing on tables
* show active users and studies in admin hub
* activity belongs to user
* new spring colors

1.2.0

* gracefully handle two digit years. closes #2616
* date picker for date of birth
* fixed upload of 100
* symlink static web images and stylesheets. symlink uploads and results to shared path. closes #2535
* typo in StudyUpload calling required_columns on self (instance) instead of StudyUpload (class)
* changing sample file to be dynamically generated, and downloaded as an attachment instead of inlined into browser. References 
#2536
* added feature for downloads #2493
* closes #2493
* version number change
* use shared bundler directory. enforce group permissions after deploy. closes #2304
* updated installation instructions, changes since 1.0.0
* change factories to prevent duplicate key contraint errors on the involvement events index. The key is violated when two facto
ry generated involvement events have the same date and event. This happens quite often. Since there are 3 events, and two possib
le days, the probability is 1/6. closes #2325

1.1.0

* adding accrual goal and reorganizing study name, title, and charts. closes #1551.
* button darkens when you hover/open, matching style of datatables. references #1536
* removing space between method and parenthesis
* make event info helper case insensitive. closes #2344
* adding irb consent template database language overlay to static pages
* adding irb consent template database language overlay
* extra language regarding consent forms in faq. references #2301
* extra language regarding consent forms in faq. closes #2301
* adding datepicker to involvement overlay. closes #1932
* cleanup of old graphs js
* cache javascripts in production via rails method. does not minify or compress. ignore javascripts/cache directory
* adding logins, accruals to front page. closes #1560
* truncate tooltip on charts. use excanvas for ie
* study irb number toggle adjustments for ie7. references #1536
* study irb number toggle button more noticable. references #1536
* fixing flash/environment centering. references #2312
* centering flash on IE7. references #2312
* not associated message for non-users, in development. references #2298
* stylesheet tweaks for IE7 - environment badge positioning and login box height. closes #2312
* only search for queries greater than 3 characters. references #1538
* adding accrual to study list tables. references #1551
* cleanup of unused study partial
* mandatory field notes. references #1929
* study info dropdown fix. references #2294
* give a not associated message for users who authenticate but aren't in users table. references #2298
* typo - an extra comma in the overlay calls in jquery.main.js. http://amix.dk/blog/post/19388. closes #2294
* method to determine whether an array of netids is represented in the User model. good for checking on people who can't log in. references #2298
* fixing enotis-support => enotissupport email. closes #2297
* adding dates from eirb. references #1551
* adding study title to study list and detail pages. closes #2288
* manually limiting search to 30 results. references #1538